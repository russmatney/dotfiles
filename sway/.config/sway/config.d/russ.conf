# russ sway config

focus_follows_mouse no
workspace_auto_back_and_forth yes

# reload
$bindsym --no-warn $mod+r reload

# kill
$bindsym $mod+q kill

# launcher
$bindsym --no-warn $mod+space exec $menu

# focus mode
$bindsym --no-warn $mod+tab focus mode_toggle

# used by apps for zoom/font inc/dec
$unbindsym $alt_mod+minus
$unbindsym $alt_mod+plus

################################################################################
# mx

# clawe-mx
$bindsym $mod+Shift+x exec clawebb -x clawe.mx/mx
$bindsym $mod+Shift+w exec clawebb -x clawe.mx/mx-suggestions
$bindsym $mod+Shift+o exec clawebb -x clawe.mx/mx-open

#################################
# resize mode

mode --pango_markup $mode_resize {
    # left will shrink the containers width
    # right will grow the containers width
    # up will shrink the containers height
    # Down will grow the containers height
    $bindsym --no-warn $left resize shrink width 20px
    $bindsym --no-warn $down resize grow height 20px
    $bindsym --no-warn $up resize shrink height 20px
    $bindsym --no-warn $right resize grow width 20px

    $bindsym --no-warn $left_alt resize shrink width 20px
    $bindsym --no-warn $down_alt resize grow height 20px
    $bindsym --no-warn $up_alt resize shrink height 20px
    $bindsym --no-warn $right_alt resize grow width 20px

    $bindsym --no-warn Shift+$left resize shrink width 80px
    $bindsym --no-warn Shift+$down resize grow height 80px
    $bindsym --no-warn Shift+$up resize shrink height 80px
    $bindsym --no-warn Shift+$right resize grow width 80px

    $bindsym --no-warn Shift+$left_alt resize shrink width 80px
    $bindsym --no-warn Shift+$down_alt resize grow height 80px
    $bindsym --no-warn Shift+$up_alt resize shrink height 80px
    $bindsym --no-warn Shift+$right_alt resize grow width 80px

    ## Resize // Window Gaps // + - ##
    $bindsym --no-warn minus gaps inner current minus 5px
    $bindsym --no-warn plus gaps inner current plus 5px

    # Return to default mode
    $bindsym --no-warn Return mode "default"
    $bindsym --no-warn Escape mode "default"
    $bindsym --no-warn q mode "default"
    $bindsym --no-warn $mod+Shift+c mode "default"

    $bindsym c floating enable, resize set width 70 ppt height 70 ppt, move position center
    $bindsym Shift+c floating enable, resize set width 90 ppt height 90 ppt, move position center
    $bindsym v floating enable, resize set width 50 ppt height 90 ppt, move position center
    $bindsym Shift+v floating enable, resize set width 96 ppt height 96 ppt, move position center

    # Move the focused window with the same, but add Shift
    # TODO not sure why this bit doesn't work
    $bindsym --no-warn $mod+$left move left
    $bindsym --no-warn $mod+$down move down
    $bindsym --no-warn $mod+$up move up
    $bindsym --no-warn $mod+$right move right
    # Ditto, with arrow keys
    $bindsym --no-warn $mod+Left move left
    $bindsym --no-warn $mod+Down move down
    $bindsym --no-warn $mod+Up move up
    $bindsym --no-warn $mod+Right move right
}

# resize
$bindsym --no-warn $mod+Shift+c mode $mode_resize

# toggle floating
$bindsym --no-warn $mod+Shift+f floating toggle

#################################
# keyboard fixes

input "type:keyboard" {
  xkb_options caps:escape

  repeat_delay 180
  repeat_rate 52
}

#################################
# scratchpad toggles

set $journal-emacs [app_id="emacs" title="journal"]
for_window $journal-emacs move scratchpad
$bindsym $mod+u $journal-emacs scratchpad show

for_window [app_id="emacs" title="floating-emacs"] move scratchpad
$bindsym --no-warn $mod+e [app_id="emacs" title="floating-emacs"] scratchpad show

for_window [app_id="firefox"] move scratchpad
$bindsym $mod+t [app_id="firefox"] scratchpad show

for_window [instance="spotify"] move scratchpad
$bindsym --no-warn $mod+$alt_mod+s [instance="spotify"] scratchpad show

for_window [class="Clove" title="tauri-doctor-focus"] move scratchpad, scratchpad show
$bindsym --no-warn $mod+$alt_mod+y [class="Clove" title="tauri-doctor-focus"] scratchpad show

for_window [class="^discord"] move scratchpad, scratchpad show
$bindsym --no-warn $mod+$alt_mod+y [class="^discord"] scratchpad show

for_window [class="Aseprite"] move scratchpad, scratchpad show
$bindsym --no-warn $mod+$alt_mod+y [class="Aseprite"] scratchpad show

# for_window [class="^1Password$"] move scratchpad, scratchpad show
# for_window [class="^Slack"] move scratchpad, scratchpad show
# for_window [class="^Obsidian"] move scratchpad, scratchpad show

#################################
# workspace nav

$bindsym --no-warn $mod+p workspace next
$bindsym --no-warn $mod+n workspace prev

#################################
# workspace terminal and emacs toggles

set $term footclient
set $term_cwd $term -D "$(swaycwd 2>/dev/null || echo $HOME)"
set $term_float footclient --app-id floating_shell --window-size-chars 82x25

# toggle term
$bindsym --no-warn $mod+Return exec $term

# toggle emacs
set $ensure_workspace_emacs clawebb -x ralphie.sway/ensure-current-workspace --app emacs
$bindsym --no-warn $mod+Shift+Return exec $ensure_workspace_emacs
